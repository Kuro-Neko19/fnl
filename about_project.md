# Работа для финального проекта.
____________________________________
____________________________________

## Основные переменные 
### В качестве основных, ключевых переменных были использованы пять переменных сессии.

* **$_SESSION['id']** - переменная хранящая в себе индентификатор пользователя равный индентификатору, хранящийся в таблице пользователей соответствующего типа.
* **$_SESSION['usr_type']** - переменная хранящая в себе значенние одного из трёх типов пользователя: admin, advertiser и master.
* **$_SESSION['usr_login']** - переменная хранящая в себе значенние логина пользователя заданное при регистрации.
* **$_SESSION['usr_name']** - переменная хранящая в себе значенние имени пользователя заданное при регистрации.
* **$_SESSION['request_token']** - переменная хранящая в себе CSRF - токен.
----
## Основная структура и функционал проекта
* Проект построен по архитектуре MVC (**Model View Controller** / **Модель Представление Контроллер**)
* В разделе **"Views/Представления"** хранятся все файлы содержащие в себе данные об отображаемых на экране пользователя страницах.
* В разделе **"Controllers/Контроллеры"** хранятся все файлы содержащие в себе данные необходимые для открытия необходимых страниц при маршрутизации.
* Раздел **"Models/Модели"** в данной работе не задействован.

* Так же в проекте присутствует **"Route/Маршрут"**, данный файл отвечает за маршрутизацию при обработке url перенаправляя пользователя на соответсвующие страницы.
---
## Основной функционал сайта реализованный в рамках финального проекта
В системе присутствуют три типа пользователя: администратор, рекламодатель и веб-мастер.
* Функционал администратора: просмотр дохода системы за текущий день, за месяц, за год и за всё время. Доход равен 20%-ам(значение можно менять в файле redirect) расхода рекламодателя с одного offer'а. Так же, администратор способен регистрировать новых рекламодателей, веб мастеров и других администраторов.
* Функционал рекламодателя: рекламодатель способен создавать offer'ы указывая их названия, описания, цены и ссылку на товар или услугу по которой будет переходить пользователь при взаимодействии с рекламой. А так же просматривать количество переходов и расход за день, за месяц, за год и за всё время.
* Функционал веб-мастера: веб-мастер способен подписываться и отписываться на offer'ы получая ссылку для встраивания. А так же просматривать доход по подписанным оферам (80% от цены offer'а) за день, месяц, год и за всё время.
* **Redirect**-система регистрирует факт перехода по ссылке полученной веб-мастером при подписывании на offer, проверяет подписан ли мастер на offer(если нет, пользователя отправляет на страницу 404), записывая индентификатор offer'а и веб-мастера расчитывая доход для мастера(80%) и для системы(20%). После чего перенаправляет пользователя по указанной в offer'е ссылке.

## Зайдействованная защита для проекта
* **CSRF**: для защиты используется токен который генерируется при запуске сессии и хранится в соответствующей переменной и существует до конца сессии. Данный токен подставляется в каждой форме и проверяется при взаимодействии с элементами формы кроме форм авторизации пользователей.
* **SQL injection**: для защиты переменны переменные в качестве параметров при отправке данных в БД, а при чтении данные из таблиц предварительно записываются в переменные для дальнейшей обработки. Так же на страницах авторизации отключено отображение ошибок для усложнения определения структуры БД злоумышленником.
* **XSS**: для защиты были экранированы поля ввода и параметры при обработке маршрутизации.